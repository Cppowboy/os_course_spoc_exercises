# 文件系统(lec 21) spoc 思考题

## 个人思考题
### 21.1 文件系统和文件 
1. 文件系统的功能是什么？

 >  负责数据持久保存，功能是数据存储和访问

 >  具体功能：文件分配、文件管理、数据可靠和安全

2. 什么是文件？

 >  文件系统中具有符号名的基本数据单位。

3. 文件系统和内存管理在功能和实现算法上有什么异同？

 > 相同：数据保存、分配、释放
 
 > 不同：数据保存的持久性、管理的数据量大小、数据可靠性、数据访问安全性、服务对象、服务接口
 
### 21.2 文件描述符
1. 打开文件时，文件系统要维护哪些信息？

 >  文件指针、打开文件计数、访问权限、文件位置和数据缓存

1. 文件系统的基本数据访问单位是什么？这对文件系统有什么影响？
1. 文件的索引访问有什么特点？如何优化索引访问的速度？
2. 文件访问方式有哪几种？文件访问方式对文件系统的设计什么影响？

### 21.3 目录、文件别名和文件系统种类
1. 什么是目录？

 >  由文件索引项组成的特殊文件。

1. 目录的组织结构是什么样的？

 >  树结构、有向图

1. 目录操作有哪些种类？
1. 什么是文件别名？软链接和硬链接有什么区别？
1. 路径遍历的流程是什么样的？如何优化路径遍历？
1. 什么是文件系统挂载？
1. 为什么会存在大量的文件系统类型？

### 21.4 虚拟文件系统 
1. 虚拟文件系统的功能是什么？

 >  对上对下的接口、高效访问实现

1. 文件卷控制块、文件控制块和目录项的相互关系是什么？
1. 可以把文件控制块放到目录项中吗？这样做有什么优缺点？


### 21.5 文件缓存和打开文件
1. 虚拟存储和文件缓存有什么区别和联系？

 > 区别：虚拟存储是用外存来模拟内存、文件缓存是用内存来模拟外存

 > 联系：虚拟存储和文件缓存同时用到物理内存，占用的内存空间是相互影响的
 
2. 文件的数据块缓存和页缓存有什么区别和联系？
 
 > 联系：物理内存空间的分配

 > 区别：数据缓存是把页面访问映射到数据块访问、页缓存是把文件访问映射到页面访问
 
3. 为什么要同时维护进程的打开文件表和操作系统的打开文件表？这两个打开文件表有什么区别和联系？为什么没有线程的打开文件表？
 
### 21.6 文件分配
1. 文件分配的三种方式是如何组织文件数据块的？各有什么特征？
1. UFS多级索引分配是如何组织文件数据块的位置信息的？

### 21.7 空闲空间管理和冗余磁盘阵列RAID
1. 硬盘空闲空间组织和文件分配有什么异同？
 
 > 空闲空间组织不需要管顺序，而文件需要维护占用数据块的顺序

 > 都需要维护管理有数据块有哪些

1. RAID-0、1、4和5分别是如何组织磁盘数据块的？各有什么特征？

## 小组思考题
 1. (spoc)完成Simple File System的功能，支持应用程序的一般文件操作。具体帮助和要求信息请看[sfs-homework](https://github.com/chyyuu/ucore_lab/blob/master/related_info/lab8/sfs-homework.md)


 1. (spoc)FAT、UFS、YAFFS、NTFS这几种文件系统中选一种，分析它的文件卷结构、目录结构、文件分配方式，以及它的变种。

ZFS:
    zfs是一个128位的文件系统，总容量是现有64位文件系统的1.84×10^19倍。
- 文件卷结构
    zfs基于存储池，不需要创建卷，把所有的设备集中到一个存储池中进行管理。
- 目录结构 
    zfs用存储池来管理物理存储空间，没有卷的概念。存储池描述存储的物理特征，采用树形的目录结构。
- 文件分配方式 
    ZFS使用一种写时拷贝事务模型技术。所有文件系统中的块指针都包括256位的能在读时被重新校验的关于目标块的校验和。含有活动数据的块从来不被覆盖；而是分配一个新块，并把修改过的数据写在新块上。所有与该块相关的元数据块都被重新读、分配和重写。为了减少该过程的开销，多次读写更新被归纳为一个事件组，并且在必要的时候使用日志来同步写操作。
    利用写时拷贝使ZFS的快照和事物功能的实现变得更简单和自然，快照功能更灵活。缺点是，COW使碎片化问题更加严重，对于顺序写生成的大文件，如果以后随机的对其中的一部分进行了更改，那么这个文件在硬盘上的物理地址就变得不再连续，未来的顺序读会变得性能比较差。

  wikipedia上的文件系统列表参考
  - http://en.wikipedia.org/wiki/List_of_file_systems
  - http://en.wikipedia.org/wiki/File_system
  - http://en.wikipedia.org/wiki/List_of_file_systems

  请同学们依据自己的选择，在下面链接处回复分析结果。
  - [FAT文件系统分析](https://piazza.com/class/i5j09fnsl7k5x0?cid=416)
  - [NTFS文件系统分析](https://piazza.com/class/i5j09fnsl7k5x0?cid=417)
  - [UFS文件系统分析](https://piazza.com/class/i5j09fnsl7k5x0?cid=418)
  - [ZFS文件系统分析](https://piazza.com/class/i5j09fnsl7k5x0?cid=861)
  - [YAFFS文件系统分析](https://piazza.com/class/i5j09fnsl7k5x0?cid=861)
